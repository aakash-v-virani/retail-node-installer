# Copyright (C) 2019 Intel Corporation
# SPDX-License-Identifier: BSD-3-Clause

# This file is automatically generated.

# Listen on this specific port instead of the standard DNS port
# (53). Setting this to zero completely disables DNS function,
# leaving only DHCP and/or TFTP.
port=0

# Set this (and domain: see below) if you want to have a domain
# automatically added to simple names in a hosts-file.
expand-hosts

# Set the domain for dnsmasq. this is optional, but if it is set, it
# does the following things.
# 1) Allows DHCP hosts to have fully qualified domain names, as long
#     as the domain part matches this setting.
# 2) Sets the "domain" DHCP option thereby potentially setting the
#    domain of all systems configured by DHCP
# 3) Provides the domain part for "expand-hosts"
domain=builder.local

# Enable the integrated DHCP server, you need
# to supply the range of addresses available for lease
#dhcp-range=@@DHCP_MIN@@,@@DHCP_MAX@@,6h
dhcp-range=@@DHCP_RANGE@@

# Override the default route supplied by dnsmasq, which assumes the
# router is the same machine as the one running dnsmasq.
dhcp-option=3,@@NETWORK_GATEWAY_IP@@

# set dns name servers
dhcp-option=6,@@NETWORK_DNS_PRIMARY@@,@@NETWORK_DNS_SECONDARY@@

# network broadcast
dhcp-option=28,@@NETWORK_BROADCAST_IP@@

# NTP server, default to this machine
# dhcp-option=42,0.0.0.0

# Serve out legacy binaries to legacy PXE clients
dhcp-match=set:legacy,option:client-arch, 0
dhcp-match=set:legacy,option:client-arch, 6
dhcp-boot=tag:legacy,lpxelinux.0

# Serve out UEFI-compatible binaries to UEFI PXE clients
dhcp-match=set:uefi,option:client-arch,7
dhcp-boot=tag:uefi,efi64/syslinux.efi

# Fallback to telling all other clients to boot lpxelinux.0
dhcp-boot=tag:!uefi,lpxelinux.0

# PXE Service
@@PXE_COMMENT@@pxe-service=x86PC, "PXELINUX (BIOS)", "lpxelinux.0"
@@PXE_COMMENT@@pxe-service=X86-64_EFI, "PXELINUX (EFI)", "efi64/syslinux.efi"

# Enable dnsmasq's built-in TFTP server
enable-tftp

# Set the root directory for files available via FTP.
tftp-root=/srv/tftp
